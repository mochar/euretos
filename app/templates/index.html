{% extends "layout.html" %}

{% block body %}
{% include 'templates.html' %}

<div class="pure-g">
    <div class="pure-u-1-3" id="left">
        <div data-bind="visible: concepts().length === 0">
            <form data-bind="submit: getConcepts">
                <div class="pure-g">
                    <div class="panel pure-u-1-2">
                        <h4>Genes (Entrez)</h4>
                        <textarea rows="20" name="genes" style="width: 100%"></textarea>
                    </div>
                    <div class="panel pure-u-1-2">
                        <h4>Metabolites (ChEBI)</h4>
                        <textarea rows="20" name="metabolites" 
                            style="width: 100%; margin-left: .3em"></textarea>
                    </div>
                </div>
                
                <button class="button button-primary" style="font-size: .9em; margin-top: .5em;" 
                        type="submit" data-bind="disable: loading">
                    <span class="fa fa-refresh fa-spin" data-bind="visible: loading"></span>
                    Submit
                </button>
            </form>
        </div>
        
        <div data-bind="visible: concepts().length > 0">
            <!--<button class="button" data-bind="click: function() { graphDirty(true); }">Update</button>-->
            <div class="pure-g" id="tabs">
                <div class="pure-u-1-5">
                    <button class="button button-strong button-transparent button-block" data-bind="click: reset">
                        <span class="fa fa-arrow-left"></span> Back
                    </button>
                </div>
                <div class="pure-u-1-5"></div>
                <div class="pure-u-1-5" style="padding-right: .3em">
                    <button class="button button-block"
                            data-bind="click: function() {tab('graph'); },
                                    css: tab() === 'graph' ? 'button-selected' : 'button-styled'">
                            Graph</button>
                </div>
                <div class="pure-u-1-5">
                    <button class="button button-block"
                            data-bind="click: function() {tab('genes'); },
                                    css: tab() === 'genes' ? 'button-selected' : 'button-styled',
                                    enable: genes().length > 0">
                            Genes</button>
                </div>
                <div class="pure-u-1-5">
                    <button class="button button-block"
                            data-bind="click: function() {tab('metabolites'); },
                                    css: tab() === 'metabolites' ? 'button-selected' : 'button-styled',
                                    enable: metabolites().length > 0">
                            Metabolites</button>
                </div>
            </div>

            <div id="result">
                {% include 'graph-tab.html' %}
                
                <div class="table-container" id="genes"
                    data-bind="template: { name: 'table-template', 
                                            data: geneTable,
                                            if: tab() === 'genes' }">
                </div>
                
                <div class="table-container" id="metabolites"
                    data-bind="template: { name: 'table-template', 
                                            data: metaboliteTable,
                                            if: tab() === 'metabolites' }">
                </div>
            </div>
        </div>
    </div>

    <div class="pure-u-2-3" id="right">
        <div class="panel" id="graph">
            <button class="button button-primary button-block" id="update-button"
                    data-bind="click: updateGraph, enable: dirty" disabled>UPDATE</button>

            <div data-bind="graph: graphDirty"></div>
        </div>
    </div>
</div>

{% endblock %}